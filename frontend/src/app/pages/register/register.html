<div class="register-container">
  <div class="register-card">
    <div class="register-header">
      <h1>ELLP</h1>
      <h2>Ensino Lúdico de Lógica e Programação</h2>
      <p>Crie sua conta para começar</p>
    </div>
    
    <form class="register-form" (ngSubmit)="onSubmit()" #registerForm="ngForm">
      <div class="form-group">
        <label for="fullName">Nome Completo</label>
        <input 
          type="text" 
          id="fullName" 
          name="fullName"
          [(ngModel)]="registerData.fullName"
          #fullName="ngModel"
          required 
          minlength="2"
          class="form-control"
          placeholder="Digite seu nome completo"
          [class.error]="fullName.invalid && fullName.touched">
        <div class="error-message" *ngIf="fullName.invalid && fullName.touched">
          <span *ngIf="fullName.errors?.['required']">Nome completo é obrigatório</span>
          <span *ngIf="fullName.errors?.['minlength']">Nome deve ter no mínimo 2 caracteres</span>
        </div>
      </div>

      <div class="form-group">
        <label for="accessCode">Código de Acesso</label>
        <input 
          type="text" 
          id="accessCode" 
          name="accessCode"
          [(ngModel)]="registerData.accessCode"
          #accessCode="ngModel"
          required 
          pattern="^[0-9]{7}$"
          maxlength="7"
          class="form-control"
          placeholder="Digite seu código de 7 dígitos"
          (input)="onAccessCodeInput($event)"
          [class.error]="accessCode.invalid && accessCode.touched">
        <div class="error-message" *ngIf="accessCode.invalid && accessCode.touched">
          <span *ngIf="accessCode.errors?.['required']">Código de acesso é obrigatório</span>
          <span *ngIf="accessCode.errors?.['pattern']">Código deve conter exatamente 7 dígitos numéricos</span>
        </div>
      </div>

      <div class="form-group">
        <label for="school">Instituição de Ensino</label>
        <select 
          id="school" 
          name="school"
          [(ngModel)]="registerData.schoolId"
          #school="ngModel"
          required
          class="form-control"
          [class.error]="school.invalid && (school.touched || formSubmitted)">
          
          <option [ngValue]="null" disabled>Selecione sua escola</option>
          <option *ngFor="let s of schools" [value]="s.id">{{ s.name }}</option>
        </select>
        <div class="error-message" *ngIf="school.invalid && (school.touched || formSubmitted)">
          <span>Selecione uma escola</span>
        </div>
      </div>


      <div class="form-group">
        <label for="password">Senha</label>
        <input 
          type="password" 
          id="password" 
          name="password"
          [(ngModel)]="registerData.password"
          #password="ngModel"
          required 
          minlength="6"
          class="form-control"
          placeholder="Digite sua senha"
          [class.error]="password.invalid && password.touched">
        <div class="error-message" *ngIf="password.invalid && password.touched">
          <span *ngIf="password.errors?.['required']">Senha é obrigatória</span>
          <span *ngIf="password.errors?.['minlength']">Senha deve ter no mínimo 6 caracteres</span>
        </div>
      </div>

      <div class="form-group">
        <label for="confirmPassword">Confirmar Senha</label>
        <input 
          type="password" 
          id="confirmPassword" 
          name="confirmPassword"
          [(ngModel)]="registerData.confirmPassword"
          #confirmPassword="ngModel"
          required 
          class="form-control"
          placeholder="Confirme sua senha"
          [class.error]="(confirmPassword.invalid && confirmPassword.touched) || (confirmPassword.touched && !passwordsMatch())">
        <div class="error-message" *ngIf="confirmPassword.invalid && confirmPassword.touched">
          <span *ngIf="confirmPassword.errors?.['required']">Confirmação de senha é obrigatória</span>
        </div>
        <div class="error-message" *ngIf="confirmPassword.touched && !passwordsMatch() && registerData.confirmPassword">
          <span>As senhas não coincidem</span>
        </div>
      </div>

      <div class="error-message" *ngIf="registerError">
        {{ registerError }}
      </div>

      <div class="success-message" *ngIf="registerSuccess">
        {{ registerSuccess }}
      </div>

      <button 
        type="submit" 
        class="btn-primary"
        [disabled]="registerForm.invalid || !passwordsMatch() || isLoading">
        <span *ngIf="!isLoading">Registrar</span>
      </button>
    </form>

    <div class="register-footer">
      <p>Já possui uma conta? 
        <a routerLink="/login" class="link">Faça login</a>
      </p>
    </div>
  </div>
</div>
